@{
    ViewData["Title"] = "医院中心";
    var hospital = ViewBag.Yixue;//数据
    var count = ViewBag.Count;//总条数
    var page1 = ViewBag.PageNum;//当前页
    var code = ViewBag.Code;
    var key = ViewBag.Key;
    var shenfen = ViewBag.Shenfen;//省份
    var where2 = ViewBag.Where2;
    var cid = ViewBag.cid;
    var k = 1;
    //IList<Makeiteminfo> [] arrlist = { };
}
@section css{
    <link href="~/web/css/article.css" rel="stylesheet" />
    <link href="~/web/css/blog.css" rel="stylesheet" />
    <link href="~/web/css/index.css" rel="stylesheet" />
    <style>
        .item-base-info {
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
        }
        .article-title{
            display: flex;
            justify-content: space-between;
        }

        .article-right .projectBtn {
            font-size: 14px !important;
            color: #009688;
        }
 
    </style>
}
    @using App.Core.Entities.Blog
    @model List<App.Core.Entities.Blog.BannerInfo>
<div class="blog-body">
    <div class="blog-container">
        <blockquote class="layui-elem-quote sitemap layui-breadcrumb shadow" style="visibility: visible;">
            <a href="/" title="网站首页">首页<span class="layui-box">&gt;</span></a>
                <a><cite>医院数据库</cite></a>
          


        </blockquote>
        <div style="background:#fff;padding: 10px">
            <form class="layui-form layui-form-pane"  id="advance-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">省份地区</label>
                    <div class="layui-input-block">
                            <select name="DJGXXshen" lay-filter="aihao" id="area">
                            <option value=""></option>
                                <option value="beijing">北京</option>
                                <option value="tianjing">天津</option>
                                <option value="hebei">河北</option>
                                <option value="shangxi">山西</option>
                                <option value="neimenggu">内蒙古</option>
                                <option value="liaoning">辽宁</option>
                                <option value="jiling">吉林</option>
                                <option value="heilongjiang">黑龙江</option>
                                <option value="shanghai">上海</option>
                                <option value="jiangshu">江苏</option>
                                <option value="zhejiang">浙江</option>
                                <option value="anhui">安徽</option>
                                <option value="fujian">福建</option>
                                <option value="jiangxi">江西</option>
                                <option value="shangdong">山东</option>
                                <option value="henan">河南</option>
                                <option value="hubei">湖北</option>
                                <option value="hunan">湖南</option>
                                <option value="guangdong">广东</option>
                                <option value="guangxi">广西</option>
                                <option value="hainan">海南</option>
                                <option value="chongqi">重庆</option>
                                <option value="sichuang">四川</option>
                                <option value="guizhou">贵州</option>
                                <option value="yunnan">云南</option>
                                <option value="xizan">西藏</option>
                                <option value="sanxi">陕西</option>
                                <option value="gansu">甘肃</option>
                                <option value="qinghai">青海</option>
                                <option value="ningxia">宁夏</option>
                                <option value="xinjiang">新疆</option>
                                <option value="xianggang">香港</option>
                                <option value="taiwang">台湾</option>
                        </select>
                    </div>
                </div>
                <div class="layui-form-item">
                    <label class="layui-form-label">专业类型</label>
                    <div class="layui-input-block">
                            <select name="Dstag" lay-filter="aihao">
                            <option value=""></option>
                                <option value="GCP中心标本库">GCP中心标本库</option>
                                <option value="临床试验中心药房">临床试验中心药房</option>
                                <option value="可牵头遗传办">可牵头遗传办</option>
                                <option value="伦理前置审批">伦理前置审批</option>
                                <option value="GCP中心标本库">GCP中心标本库</option>
                                <option value="中心实验室">中心实验室</option>
                                <option value="临床试验专用病房">临床试验专用病房</option>
                                <option value="牵头项目伦理随到随审">牵头项目伦理随到随审</option>
                        </select>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">试验分类</label>
                    <div class="layui-input-block">
                        <select name="interest2" lay-filter="aihao">
                            <option value=""></option>
                                <option value="安全性">安全性</option>
                                <option value="有效性" >有效性</option>
                                <option value="安全性和有效性">安全性和有效性</option>
                        </select>
                    </div>
                </div>

                <div class="layui-form-item">
                    <label class="layui-form-label">试验状态</label>
                    <div class="layui-input-block">
                        <select name="interest3" lay-filter="aihao">
                            <option value=""></option>
                                <option value="进行中-尚未招募">进行中-尚未招募</option>
                                <option value="进行中-招募中">进行中-招募中</option>
                                <option value="进行中-招募完成">进行中-招募完成</option>
                        </select>
                    </div>
                </div>

                <div class="layui-form-item" pane="">
                    <label class="layui-form-label">试验范围</label>
                    <div class="layui-input-block">
                        <input type="radio" name="sex" value="国内试验" title="国内试验" >
                        <input type="radio" name="sex" value="国际多中心试验" title="国际多中心试验">
                        <input type="radio" name="sex" value="NK" title="NK" title="NK">
                        

                    </div>
                </div>

                <div class="layui-form-item" pane="">
                    <label class="layui-form-label">
                        试验分期
                    </label>
                    <div class="layui-input-block">
                        <input type="radio" name="qishu" value="I 期" title="I 期" >
                            <input type="radio" name="qishu" value="II 期" title="II 期">
                            <input type="radio" name="qishu" value="III 期" title="II 期">
                    </div>
                </div>

                <div class="layui-row">
                    <div class="layui-col-xs6">
                        <div class="layui-form-item">
                            <label class="layui-form-label">机构名称</label>
                            <div class="layui-input-block">
                                    <input type="text" name="Dsname" autocomplete="off" placeholder="请输入机构名称" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-xs6">
                        <div class="layui-form-item">
                            <label class="layui-form-label">病房床位</label>
                            <div class="layui-input-block">
                                    <input type="text" name="DLCSYgcc" autocomplete="off" placeholder="请输入病房床位" class="layui-input">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="layui-row">
                    <div class="layui-col-xs6">
                        <div class="layui-form-item">
                            <label class="layui-form-label">药物名称</label>
                            <div class="layui-input-block">
                                <input type="text" name="title" autocomplete="off" placeholder="请输入药物名称" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-xs6">
                        <div class="layui-form-item">
                            <label class="layui-form-label">适应症</label>
                            <div class="layui-input-block">
                                <input type="text" name="title1" autocomplete="off" placeholder="请输入适应症" class="layui-input">
                            </div>
                        </div>
                    </div>
                </div>
      
                <div class="layui-row">
                    <div class="layui-col-xs6">
                        <div class="layui-form-item">
                            <label class="layui-form-label">申请人</label>
                            <div class="layui-input-block">
                                <input type="text" name="title2" autocomplete="off" placeholder="请输入申请人" class="layui-input">
                            </div>
                        </div>
                    </div>
                    <div class="layui-col-xs6">
                        <div class="layui-form-item">
                            <label class="layui-form-label">主要研究者</label>
                            <div class="layui-input-block">
                                <input type="text" name="title3" autocomplete="off" placeholder="请输入主要研究者" class="layui-input">
                            </div>
                        </div>
                    </div>
                </div>
            </form>
            <button id="search-btn" class="layui-btn" lay-submit="" lay-filter="demo2">查询</button>
        </div>
        <div class="blog-main">
            <div id="parentArticleList" class="blog-main-left animated slideInLeft">
               @* <div class="flow-default" id="articlelist">

                </div>*@
                @foreach (Articleiteminfo info in hospital)
                {
                    int i = 0;

                    if (info.projectcount != "0") {

                        k++;
                    <div class="article shadow animated zoomIn">
                        <div class="article-left "> <img src="https://storage.yscro.com/defaut_logo_new6.jpg?imageView2/1/h/115/w/110" alt=""> </div>
                        <div class="article-right">
                            <div class="article-title">
                                @*                                <span class="article_is_top">置顶</span>&nbsp; <span class="article_is_yc">
                            原创
                            </span>*@
                                <a href="/home/about?tid=@info.Syurl&sid=@shenfen" class="index-block"> @info.Syname</a>  <a href="javascript:void(0)" data="@info.Syname" class="index-block projectBtn"> 符合项目： @info.projectcount</a>
                            </div>
                            <div class=" article-footer">
                                @if (info.Sytag != "")
                                {
                                    <a href="/home/index?code=1&state=10&tag=2&key=Sytag2:333@@Sytag4:888@@Sytag4:null" class="flag">
                                        @*tag 1:普通查询 直接传值 2:高级查询 Sytag2:333@@Sytag4:888 (后端没有做判断， ：后面取不到值就传 string "" )*@
                                        @info.Sytag
                                    </a>
                                }
                                @if (info.Sytag1 != "")
                                {
                                    <a href="/article/list?tid=1085792939428417536" class="flag1">
                                        @info.Sytag1
                                    </a>
                                }
                                @if (info.Sytag2 != "")
                                {
                                    <a href="/article/list" class="flag">
                                        @info.Sytag2
                                    </a>
                                }

                                @if (info.Sytag4 != "")
                                {
                                    <a href="/article/list?tid=1085792939428417536" class="flag2">
                                        @info.Sytag4
                                    </a>
                                }

                            </div>
                        </div>
                        <br />
                        <div class="article-right-new item-base-info">
                            <a class="index-block">基本信息：</a> @info.Syxiangmu
                        </div>
                        <div class="article-right-new item-base-info">
                            <a class="index-block">机构电话：</a> @info.Syphnoe
                        </div>
                        <br />
                        @if (@info.Syjiedaishijian != null && @info.Syjiedaishijian != "")
                        {
                            <div class="article-right-new">
                                <a class="index-block">接待时间：</a> @info.Syjiedaishijian
                            </div>
                        }
                        <br />

                        @if (@info.Syadress != null && @info.Syadress != "")
                        {
                            <div class="article-right-new">
                                <a class="index-block">机构地址：</a> @info.Syadress
                            </div>
                        }
                        <div class="clear">
                        </div>

                    </div>
                    }
                }
                共 ：<a class="index-block-jiguo">@count </a> 条
                <div id="demo0" style="text-align:center;"></div>
                <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
                    <legend style="display:none" id="pageCount">@count</legend>
                </fieldset>
            </div>
            <div class="blog-main-right">
                <div class="blog-search animated fadeInRight">
                    <div class="layui-form-item">
                        <div class="search-keywords  shadow">
                            <input type="text" id="keywords" name="keywords" lay-filter="searchInput" lay-verify="required" placeholder="输入关键词搜索" autocomplete="off" class="layui-input">
                        </div>
                        <div class="search-submit  shadow">
                            <a class="search-btn" lay-submit="search" lay-filter="search"><i class="fa fa-search"></i></a>
                        </div>
                    </div>
                </div>
                <div class="article-category shadow categoryOut">
                    <div class="article-category-title" id="category">分类导航</div>
                    <div class="clear"></div>
                </div>
                <!--热门文章-->
                <div class="layui-tab layui-tab-brief shadow animated fadeInRight blog-module">
                    <div class="blog-module-title"><i class="layui-icon layui-icon-fire"></i>&nbsp;热门文章</div>
                    @*  <ul class="hot-list" id="hot">
                    </ul>*@
                    <ui class="hot-list" id="hot1">
                        @foreach (Articleiteminfo info in hospital)
                        {
                            <li>
                                <a href="/home/about">
                                    <img src="https://storage.yscro.com/defaut_logo_new6.jpg?imageView2/1/h/115/w/110">
                                </a>
                                <div class="hot-right-box">
                                    <h4>
                                        <a href="/home/about" class="index-block-jiguo">
                                            @info.Syname
                                        </a>
                                    </h4>
                                    <p class="hot-date">
                                        <i class="layui-icon layui-icon-date"></i>
                                        <a>机构电话： @info.Syphnoe</a>
                                    </p>
                                    @*                              <p class="hot-view">
                                <i class="layui-icon layui-icon-read"></i>
                                <a>122</a>
                                </p>*@
                                </div>
                            </li>
                        }
                    </ui>
                </div>
                <div class="category-toggle"><i class="fa fa-chevron-left"></i></div>
            </div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div class="dialog">
</div>
<style>
    .dialogBox #projectBox {
        display: none;
    }
    #projectBox #page{
        display: flex;
        justify-content: center;
    }
</style>
<script id="newsview" type="text/template">
    <div class="article shadow animated zoomIn">
        <div class="article-left ">
            <img src="{{d.Thumbnail}}" alt="{{d.Title}}">
        </div>
        <div class="article-right">
            <div class="article-title">
                {{# if(d.IsTop){}}
                <span class="article_is_top">置顶</span>&nbsp;
                {{#} }}


                {{#  if(d.CreativeType == 0){ }}
                <span class="article_is_yc">
                    原创
                </span>&nbsp;
                {{#  }else{ }}
                <span class="article_is_zz">
                    转载
                </span>&nbsp;
                {{#} }}

                <a href="/article/detail/{{d.Id}}">{{d.Title}}</a>
            </div>
            <div class="article-abstract">
                {{d.Summary}}
            </div>
        </div>
        <div class="clear"></div>
        <div class="article-footer">
            <span><i class="fa fa-clock-o"></i>&nbsp;&nbsp;{{d.PublishDate}}</span>
            <span class="article-author"><i class="fa fa-user"></i>&nbsp;&nbsp; {{d.Author}}</span>
            <span>
                <i class="fa fa-tag"></i>&nbsp;&nbsp;
                {{#  layui.each(d.Tags, function(i, curr){}}
                <a href="/article/list?tid={{curr.Id}}" class="flag"> {{curr.TagName}}</a>
                {{#  }); }}
            </span>
            <span class="article-viewinfo"><i class="fa fa-eye"></i>&nbsp;{{d.ReadTimes}}</span>
            <span class="article-viewinfo"><i class="fa fa-commenting"></i>&nbsp;{{d.MsgTimes}}</span>
        </div>
    </div>
</script>
<script type="text/template" id="categoryview">
    {{#  layui.each(d, function(index, item){ }}
    <a href="/article/list?cid={{item.Id}}">{{item.CategoryName}}</a>
    {{#  }); }}
</script>

@section script{
    <script src="~/web/js/article.js"></script>
    <script>
        let keyStrAll = ''
        document.querySelector("#search-btn").onclick = function () {
            let arr = ['DJGXXshen', 'Dstag', 'interest2', 'interest3', 'interest3', 'sex', 'qishu', 'Dsname', 'DLCSYgcc'
            , 'title'
            , 'title1'
            , 'title2'
            , 'title3'
        ]
            let formData = {}
            for(let item of arr) {
                formData[item] = document.getElementsByName(item)[0].value
            }
            let keyStr = 'key='
            for (const key in formData) {
                keyStr = keyStr + key + ':' + (formData[key] || 'null') + '$$'
            }
            keyStrAll = keyStr
            const url = '/article/list?tid=6&code=1&state=10&tag=2&' + keyStr
            window.location.href = url
            
        }
        let curr = 1
        layui.use(['laypage', 'layer'], function () {
            var laypage = layui.laypage
            var dropdown = layui.dropdown
            laypage.render({
                elem: 'demo0'
                , curr: @code
                                , count: @count //数据总数
                                    , jump: function (obj, first) {
                    if (!first) {
                        curr = obj.curr
                        window.location.href = "/article/list?tid=7&where2=@where2&state=10&code=" + 9999 + "&" + keyStrAll
                        console.log(obj)
                    }

                }
            });
        })
    </script>
    <script type="text/javascript">

        layui.use(['jquery', 'table', 'laypage'], function () {
            var laypage1 = layui.laypage;
            laypage1.render({
                elem: 'page' //注意，这里的 test1 是 ID，不用加 # 号
                ,count: 50 //数据总数，从服务端得到
            });
            const $ = layui.$
            $(function () {
                $('.projectBtn').each(function(){

                    console.log($(this).attr('data'))
                    $(this).on().on("click", function () {
                        var cid =  $(this).attr('data');
                        var cc = '%进行中-尚未招募%';
                        layer.open({
                            type: 2,
                            content: 'http://localhost:5003/article/ListDetail?tid=8&cc=@cid&where2=@where2' + '&cid=' + cid,
                            area: ['65%', '580px'],
                            title: '符合项目'
                        });
                        layui.table.init('demo6', {});
                    })
                })
            })
        })
    </script>
}